<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
    <meta name="theme-color" content="#86bd5e">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="CO-OP Hub">
    <meta name="description" content="North Tokyo COOP Hub - Community Platform for 36,000 members">
    
    <title>ÂåóÊù±‰∫¨CO-OP Hub</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%2386bd5e'/%3E%3Ctext x='50' y='65' text-anchor='middle' font-size='40' fill='white'%3Eü§ù%3C/text%3E%3C/svg%3E">
    
    <!-- Tailwind CSS (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        coop: {
                            50: '#f0fdf4',
                            100: '#dcfce7',
                            200: '#bbf7d0',
                            300: '#86efac',
                            400: '#4ade80',
                            500: '#86bd5e',
                            600: '#6b9c4e',
                            700: '#166534',
                            800: '#14532d',
                            900: '#052e16',
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/app.css">
</head>
<body class="bg-gray-50 antialiased" x-data="coopApp()" x-cloak>

    <!-- ============================================
         LOGIN VIEW
         ============================================ -->
    <div x-show="currentView === 'login'" x-transition:enter="animate-fade-in" class="min-h-screen">
        <div class="flex flex-col items-center justify-center min-h-screen p-6 bg-gradient-to-br from-green-50 via-white to-blue-50">
            
            <!-- Language Toggle (Top Right) -->
            <div class="absolute top-6 right-6 flex items-center space-x-2">
                <span class="text-xs font-medium" :class="language === 'ja' ? 'text-coop-600' : 'text-gray-400'">Êó•Êú¨Ë™û</span>
                <label class="lang-switch">
                    <input type="checkbox" :checked="language === 'en'" @change="toggleLanguage()">
                    <span class="lang-slider"></span>
                </label>
                <span class="text-xs font-medium" :class="language === 'en' ? 'text-coop-600' : 'text-gray-400'">EN</span>
            </div>
            
            <!-- Logo -->
            <div class="mb-8 text-center">
                <div class="w-28 h-28 mx-auto mb-6 bg-coop-500 rounded-full flex items-center justify-center shadow-xl">
                    <svg class="w-14 h-14 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                    </svg>
                </div>
                <h1 class="text-4xl font-bold text-gray-800 mb-2" x-text="t.login.title"></h1>
                <p class="text-lg text-gray-600 mb-1" x-text="t.login.subtitle"></p>
                <p class="text-sm text-gray-500" x-text="t.common.tagline"></p>
            </div>
            
            <!-- QR Scanner Simulation -->
            <div x-show="showQRScanner" class="mb-8">
                <div class="bg-white rounded-2xl shadow-xl p-6 text-center">
                    <p class="text-sm text-gray-600 mb-4" x-text="t.login.simulatedQR"></p>
                    <div class="qr-scanner-frame mx-auto mb-4 bg-gray-100">
                        <div class="qr-scanner-corners"></div>
                        <div x-show="isScanning" class="qr-scan-line"></div>
                        <div class="flex items-center justify-center h-full">
                            <span class="text-6xl">üì±</span>
                        </div>
                    </div>
                    <p x-show="isScanning" class="text-sm text-coop-600 animate-pulse" x-text="t.login.scanning"></p>
                    
                    <!-- Role Selection After "Scan" -->
                    <div x-show="!isScanning" class="mt-4 space-y-2">
                        <p class="text-sm text-gray-600 mb-3" x-text="t.login.selectRole"></p>
                        <button @click="selectRoleAndLogin('reijikai')" class="w-full py-3 px-4 bg-purple-50 hover:bg-purple-100 rounded-lg text-left flex items-center transition-colors">
                            <span class="text-2xl mr-3">üëî</span>
                            <div class="flex-1">
                                <span class="font-medium text-purple-800" x-text="t.roles.reijikai.fullName"></span>
                                <p class="text-xs text-purple-600" x-text="t.roles.reijikai.desc"></p>
                            </div>
                        </button>
                        <button @click="selectRoleAndLogin('shokuin')" class="w-full py-3 px-4 bg-blue-50 hover:bg-blue-100 rounded-lg text-left flex items-center transition-colors">
                            <span class="text-2xl mr-3">üíº</span>
                            <div class="flex-1">
                                <span class="font-medium text-blue-800" x-text="t.roles.shokuin.fullName"></span>
                                <p class="text-xs text-blue-600" x-text="t.roles.shokuin.desc"></p>
                            </div>
                        </button>
                        <button @click="selectRoleAndLogin('volunteer')" class="w-full py-3 px-4 bg-green-50 hover:bg-green-100 rounded-lg text-left flex items-center transition-colors">
                            <span class="text-2xl mr-3">ü§ù</span>
                            <div class="flex-1">
                                <span class="font-medium text-green-800" x-text="t.roles.volunteer.fullName"></span>
                                <p class="text-xs text-green-600" x-text="t.roles.volunteer.desc"></p>
                            </div>
                        </button>
                        <button @click="showQRScanner = false" class="w-full mt-2 text-sm text-gray-500 hover:text-gray-700" x-text="t.common.cancel"></button>
                    </div>
                </div>
            </div>
            
            <!-- Main Login Card -->
            <div x-show="!showQRScanner" class="w-full max-w-md">
                <!-- QR Scan Button -->
                <button @click="startQRScan()" class="w-full bg-white rounded-2xl shadow-xl p-6 mb-4 text-center card-hover">
                    <div class="w-16 h-16 mx-auto mb-4 bg-coop-100 rounded-full flex items-center justify-center">
                        <svg class="w-8 h-8 text-coop-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"></path>
                        </svg>
                    </div>
                    <h2 class="text-lg font-semibold text-gray-800 mb-1" x-text="t.login.scanQR"></h2>
                    <p class="text-sm text-gray-600" x-text="t.login.scanQRDesc"></p>
                </button>
                
                <!-- Demo Role Selection -->
                <div class="bg-white rounded-2xl shadow-xl p-6">
                    <h3 class="text-center font-semibold text-gray-700 mb-2" x-text="t.login.selectRole"></h3>
                    <p class="text-center text-xs text-gray-500 mb-6" x-text="t.login.selectRoleDesc"></p>
                    
                    <!-- Role Cards -->
                    <div class="space-y-3 mb-6">
                        <!-- Reijikai -->
                        <button 
                            @click="selectedRole = 'reijikai'"
                            :class="selectedRole === 'reijikai' ? 'ring-2 ring-purple-400 bg-purple-50' : 'hover:bg-gray-50'"
                            class="w-full p-4 border-2 border-gray-200 rounded-xl transition-all text-left">
                            <div class="flex items-center">
                                <span class="text-3xl mr-4">üëî</span>
                                <div class="flex-1">
                                    <p class="font-bold text-gray-800" x-text="t.roles.reijikai.name"></p>
                                    <p class="text-xs text-gray-500" x-text="t.roles.reijikai.desc"></p>
                                </div>
                                <span class="badge badge-reijikai text-xs" x-text="t.roles.reijikai.fullName"></span>
                            </div>
                        </button>
                        
                        <!-- Shokuin -->
                        <button 
                            @click="selectedRole = 'shokuin'"
                            :class="selectedRole === 'shokuin' ? 'ring-2 ring-blue-400 bg-blue-50' : 'hover:bg-gray-50'"
                            class="w-full p-4 border-2 border-gray-200 rounded-xl transition-all text-left">
                            <div class="flex items-center">
                                <span class="text-3xl mr-4">üíº</span>
                                <div class="flex-1">
                                    <p class="font-bold text-gray-800" x-text="t.roles.shokuin.name"></p>
                                    <p class="text-xs text-gray-500" x-text="t.roles.shokuin.desc"></p>
                                </div>
                                <span class="badge badge-shokuin text-xs" x-text="t.roles.shokuin.fullName"></span>
                            </div>
                        </button>
                        
                        <!-- Volunteer -->
                        <button 
                            @click="selectedRole = 'volunteer'"
                            :class="selectedRole === 'volunteer' ? 'ring-2 ring-green-400 bg-green-50' : 'hover:bg-gray-50'"
                            class="w-full p-4 border-2 border-gray-200 rounded-xl transition-all text-left">
                            <div class="flex items-center">
                                <span class="text-3xl mr-4">ü§ù</span>
                                <div class="flex-1">
                                    <p class="font-bold text-gray-800" x-text="t.roles.volunteer.name"></p>
                                    <p class="text-xs text-gray-500" x-text="t.roles.volunteer.desc"></p>
                                </div>
                                <span class="badge badge-volunteer text-xs" x-text="t.roles.volunteer.fullName"></span>
                            </div>
                        </button>
                    </div>
                    
                    <!-- Permissions Preview -->
                    <div x-show="selectedRole" x-transition class="bg-gray-50 rounded-xl p-4 mb-6">
                        <h4 class="text-xs font-semibold text-gray-600 mb-3" x-text="t.login.permissions"></h4>
                        <ul class="space-y-2 text-sm text-gray-700">
                            <li class="flex items-center">
                                <svg class="w-4 h-4 text-coop-500 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>
                                <span x-text="selectedRole ? t.roles[selectedRole].perm1 : ''"></span>
                            </li>
                            <li class="flex items-center">
                                <svg class="w-4 h-4 text-coop-500 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>
                                <span x-text="selectedRole ? t.roles[selectedRole].perm2 : ''"></span>
                            </li>
                            <li class="flex items-center">
                                <svg class="w-4 h-4 text-coop-500 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>
                                <span x-text="selectedRole ? t.roles[selectedRole].perm3 : ''"></span>
                            </li>
                            <li class="flex items-center">
                                <svg class="w-4 h-4 text-coop-500 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>
                                <span x-text="selectedRole ? t.roles[selectedRole].perm4 : ''"></span>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- Login Button -->
                    <button 
                        @click="login()"
                        :disabled="!selectedRole"
                        :class="selectedRole ? 'bg-coop-500 hover:bg-coop-600' : 'bg-gray-300 cursor-not-allowed'"
                        class="w-full text-white py-4 rounded-xl font-medium text-lg transition-colors shadow-lg">
                        <span x-text="t.login.demoButton"></span>
                    </button>
                </div>
                
                <!-- Privacy Notice -->
                <div class="mt-6 bg-blue-50 border border-blue-200 rounded-xl p-4">
                    <p class="text-sm text-blue-800">
                        <strong>üîí <span x-text="t.login.privacyTitle"></span></strong>
                        <span x-text="t.login.privacyText"></span>
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ============================================
         MAIN APP (After Login)
         ============================================ -->
    <div x-show="currentView !== 'login'" x-transition:enter="animate-fade-in" class="min-h-screen pb-20">
        
        <!-- Header -->
        <header class="bg-white border-b shadow-sm sticky top-0 z-40">
            <div class="px-4 py-3">
                <div class="flex items-center justify-between">
                    <!-- Logo & Title -->
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-coop-500 rounded-full flex items-center justify-center flex-shrink-0">
                            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                            </svg>
                        </div>
                        <div class="min-w-0">
                            <h1 class="text-base font-bold text-gray-800 truncate" x-text="t.common.appName"></h1>
                        </div>
                    </div>
                    
                    <!-- Right Controls -->
                    <div class="flex items-center space-x-3">
                        <!-- Language Toggle -->
                        <button @click="toggleLanguage()" class="p-2 hover:bg-gray-100 rounded-full transition-colors">
                            <span class="text-sm font-medium" x-text="language === 'ja' ? 'EN' : 'Êó•Êú¨Ë™û'"></span>
                        </button>
                        
                        <!-- User Avatar -->
                        <div class="flex items-center space-x-2">
                            <span class="badge text-xs" :class="getRoleBadgeClass()" x-text="getRoleName()"></span>
                            <div class="w-9 h-9 bg-coop-100 rounded-full flex items-center justify-center">
                                <span class="text-lg" x-text="user?.avatar || 'üë§'"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Main Content Area -->
        <main class="main-content">
            
            <!-- ============================================
                 DASHBOARD VIEW
                 ============================================ -->
            <div x-show="currentView === 'dashboard'" class="view-transition p-4">
                <!-- Welcome Message -->
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">
                        <span x-text="t.dashboard.welcome"></span>, <span x-text="getUserDisplayName()"></span>
                        <span x-show="language === 'ja'">„Åï„Çì</span>
                    </h2>
                    <p class="text-sm text-gray-600 mt-1" x-text="getRoleDescription()"></p>
                </div>
                
                <!-- Role Banner -->
                <div class="rounded-xl p-4 mb-6" :class="{
                    'bg-gradient-to-r from-purple-50 to-purple-100 border border-purple-200': userRole === 'reijikai',
                    'bg-gradient-to-r from-blue-50 to-blue-100 border border-blue-200': userRole === 'shokuin',
                    'bg-gradient-to-r from-green-50 to-green-100 border border-green-200': userRole === 'volunteer'
                }">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-bold text-gray-800" x-text="getRoleWelcome()"></h3>
                        </div>
                        <span class="badge" :class="getRoleBadgeClass()" x-text="getRoleFullName()"></span>
                    </div>
                </div>
                
                <!-- Quick Stats Grid -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="stat-card">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-xs text-gray-500" x-text="t.dashboard.activeRequests"></p>
                                <p class="stat-card-value">5</p>
                            </div>
                            <div class="stat-card-icon bg-blue-100">
                                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-xs text-gray-500" x-text="t.dashboard.upcomingEvents"></p>
                                <p class="stat-card-value">3</p>
                            </div>
                            <div class="stat-card-icon bg-purple-100">
                                <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Role-specific stats -->
                    <template x-if="userRole === 'reijikai'">
                        <div class="stat-card">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-xs text-gray-500" x-text="t.dashboard.activeProposals"></p>
                                    <p class="stat-card-value">2</p>
                                </div>
                                <div class="stat-card-icon bg-purple-100">
                                    <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </template>
                    
                    <template x-if="userRole === 'shokuin'">
                        <div class="stat-card">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-xs text-gray-500" x-text="t.dashboard.pendingContent"></p>
                                    <p class="stat-card-value">7</p>
                                </div>
                                <div class="stat-card-icon bg-blue-100">
                                    <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </template>
                    
                    <template x-if="userRole === 'volunteer'">
                        <div class="stat-card">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-xs text-gray-500" x-text="t.dashboard.helpOffered"></p>
                                    <p class="stat-card-value">12</p>
                                </div>
                                <div class="stat-card-icon bg-green-100">
                                    <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </template>
                    
                    <div class="stat-card">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-xs text-gray-500" x-text="t.dashboard.newArticles"></p>
                                <p class="stat-card-value">8</p>
                            </div>
                            <div class="stat-card-icon bg-yellow-100">
                                <svg class="w-6 h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="mb-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4" x-text="t.dashboard.quickActions"></h3>
                    
                    <div class="grid grid-cols-1 gap-3">
                        <!-- Role-specific actions -->
                        <template x-if="userRole === 'reijikai'">
                            <div class="space-y-3">
                                <button @click="navigate('decisions')" class="w-full bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-xl p-4 text-left shadow-lg">
                                    <div class="flex items-center">
                                        <svg class="w-8 h-8 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
                                        </svg>
                                        <div>
                                            <p class="font-semibold" x-text="t.nav.decisions"></p>
                                            <p class="text-xs text-purple-100" x-text="t.decisions.activeProposals"></p>
                                        </div>
                                    </div>
                                </button>
                            </div>
                        </template>
                        
                        <template x-if="userRole === 'shokuin'">
                            <div class="space-y-3">
                                <button @click="navigate('content')" class="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl p-4 text-left shadow-lg">
                                    <div class="flex items-center">
                                        <svg class="w-8 h-8 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                        </svg>
                                        <div>
                                            <p class="font-semibold" x-text="t.nav.contentManagement"></p>
                                            <p class="text-xs text-blue-100" x-text="t.content.publishedNews"></p>
                                        </div>
                                    </div>
                                </button>
                            </div>
                        </template>
                        
                        <template x-if="userRole === 'volunteer'">
                            <div class="space-y-3">
                                <button @click="navigate('community')" class="w-full bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl p-4 text-left shadow-lg">
                                    <div class="flex items-center">
                                        <svg class="w-8 h-8 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                                        </svg>
                                        <div>
                                            <p class="font-semibold" x-text="t.community.title"></p>
                                            <p class="text-xs text-green-100" x-text="t.community.subtitle"></p>
                                        </div>
                                    </div>
                                </button>
                            </div>
                        </template>
                    </div>
                </div>
                
                <!-- Recent News Preview -->
                <div>
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold text-gray-800" x-text="t.nav.news"></h3>
                        <button @click="navigate('news')" class="text-sm text-coop-600 font-medium" x-text="t.common.viewAll"></button>
                    </div>
                    
                    <div class="space-y-3">
                        <template x-for="article in getNewsArticles().slice(0, 2)" :key="article.id">
                            <div @click="selectedNewsArticle = article; navigate('news')" class="card p-4 card-interactive">
                                <div class="flex items-start">
                                    <div class="flex-1 min-w-0">
                                        <span class="inline-block px-2 py-1 text-xs font-medium rounded-md bg-coop-100 text-coop-700 mb-2" x-text="article.displayCategory"></span>
                                        <h4 class="font-semibold text-gray-800 text-sm mb-1 line-clamp-2" x-text="article.displayTitle"></h4>
                                        <p class="text-xs text-gray-500" x-text="formatShortDate(article.date)"></p>
                                    </div>
                                    <svg class="w-5 h-5 text-gray-400 ml-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                    </svg>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
            
            <!-- ============================================
                 NEWS VIEW
                 ============================================ -->
            <div x-show="currentView === 'news'" class="view-transition">
                <!-- News Detail -->
                <template x-if="selectedNewsArticle">
                    <div class="p-4">
                        <button @click="selectedNewsArticle = null" class="flex items-center text-coop-600 mb-4">
                            <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                            </svg>
                            <span x-text="t.common.back"></span>
                        </button>
                        
                        <article class="bg-white rounded-xl p-6 shadow-sm">
                            <span class="inline-block px-3 py-1 text-xs font-medium rounded-full bg-coop-100 text-coop-700 mb-4" x-text="selectedNewsArticle.displayCategory"></span>
                            <h1 class="text-2xl font-bold text-gray-800 mb-4" x-text="selectedNewsArticle.displayTitle"></h1>
                            <div class="flex items-center text-sm text-gray-500 mb-6">
                                <span x-text="selectedNewsArticle.displayAuthor"></span>
                                <span class="mx-2">‚Ä¢</span>
                                <span x-text="formatDate(selectedNewsArticle.date)"></span>
                            </div>
                            <div class="prose prose-sm max-w-none text-gray-700 whitespace-pre-line" x-text="selectedNewsArticle.displayContent"></div>
                        </article>
                    </div>
                </template>
                
                <!-- News List -->
                <template x-if="!selectedNewsArticle">
                    <div class="p-4">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2" x-text="t.news.title"></h2>
                        <p class="text-sm text-gray-600 mb-6" x-text="t.news.subtitle"></p>
                        
                        <!-- Pinned News -->
                        <template x-for="article in getPinnedNews()" :key="article.id">
                            <div @click="selectedNewsArticle = article" class="card p-4 mb-4 card-interactive border-l-4 border-coop-500">
                                <div class="flex items-center mb-2">
                                    <span class="inline-block px-2 py-1 text-xs font-medium rounded-md bg-red-100 text-red-700 mr-2" x-text="t.news.pinned"></span>
                                    <span class="inline-block px-2 py-1 text-xs font-medium rounded-md bg-coop-100 text-coop-700" x-text="article.displayCategory"></span>
                                </div>
                                <h3 class="font-bold text-gray-800 mb-2" x-text="article.displayTitle"></h3>
                                <p class="text-sm text-gray-600 mb-3 line-clamp-2" x-text="article.displayExcerpt"></p>
                                <div class="flex items-center justify-between text-xs text-gray-500">
                                    <span x-text="formatShortDate(article.date)"></span>
                                    <span>üëÅ <span x-text="article.views"></span></span>
                                </div>
                            </div>
                        </template>
                        
                        <!-- Regular News -->
                        <div class="space-y-3">
                            <template x-for="article in getRegularNews()" :key="article.id">
                                <div @click="selectedNewsArticle = article" class="card p-4 card-interactive">
                                    <span class="inline-block px-2 py-1 text-xs font-medium rounded-md bg-coop-100 text-coop-700 mb-2" x-text="article.displayCategory"></span>
                                    <h3 class="font-semibold text-gray-800 mb-2" x-text="article.displayTitle"></h3>
                                    <p class="text-sm text-gray-600 mb-3 line-clamp-2" x-text="article.displayExcerpt"></p>
                                    <div class="flex items-center justify-between text-xs text-gray-500">
                                        <span x-text="formatShortDate(article.date)"></span>
                                        <span>üëÅ <span x-text="article.views"></span></span>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                </template>
            </div>
            
            <!-- ============================================
                 COMMUNITY VIEW
                 ============================================ -->
            <div x-show="currentView === 'community'" class="view-transition">
                <!-- Request Detail Modal -->
                <template x-if="showRequestDetail">
                    <div class="fixed inset-0 z-50 bg-black/50 flex items-end sm:items-center justify-center" @click.self="showRequestDetail = null">
                        <div class="bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-lg max-h-[90vh] overflow-y-auto animate-slide-up">
                            <div class="p-4 border-b sticky top-0 bg-white">
                                <div class="flex items-center justify-between">
                                    <h3 class="font-bold text-lg" x-text="showRequestDetail.displayTitle"></h3>
                                    <button @click="showRequestDetail = null" class="p-2 hover:bg-gray-100 rounded-full">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="p-4">
                                <div class="flex items-center space-x-2 mb-4">
                                    <span class="text-2xl" x-text="showRequestDetail.categoryInfo?.icon"></span>
                                    <span class="px-2 py-1 rounded-md text-xs font-medium" :class="getCategoryColor(showRequestDetail.categoryInfo?.color)" x-text="language === 'en' ? showRequestDetail.categoryInfo?.nameEn : showRequestDetail.categoryInfo?.name"></span>
                                    <span class="px-2 py-1 rounded-md text-xs font-medium" :class="getTypeBadgeClass(showRequestDetail.type)" x-text="t.community.requestTypes[showRequestDetail.type]"></span>
                                    <template x-if="showRequestDetail.urgency === 'urgent'">
                                        <span class="px-2 py-1 rounded-md text-xs font-medium bg-red-100 text-red-700" x-text="t.community.urgency.urgent"></span>
                                    </template>
                                </div>
                                
                                <p class="text-gray-700 mb-4" x-text="showRequestDetail.displayDescription"></p>
                                
                                <div class="bg-gray-50 rounded-lg p-3 mb-4">
                                    <div class="grid grid-cols-2 gap-3 text-sm">
                                        <div>
                                            <p class="text-gray-500" x-text="t.community.postedBy"></p>
                                            <p class="font-medium" x-text="showRequestDetail.userName"></p>
                                        </div>
                                        <div>
                                            <p class="text-gray-500" x-text="t.common.area"></p>
                                            <p class="font-medium" x-text="showRequestDetail.displayArea"></p>
                                        </div>
                                        <template x-if="showRequestDetail.date">
                                            <div>
                                                <p class="text-gray-500" x-text="t.common.date"></p>
                                                <p class="font-medium" x-text="formatDate(showRequestDetail.date)"></p>
                                            </div>
                                        </template>
                                        <div>
                                            <p class="text-gray-500" x-text="t.common.time"></p>
                                            <p class="font-medium" x-text="t.profile.timeSlots[showRequestDetail.timeSlot]"></p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex items-center justify-between text-sm text-gray-500 mb-6">
                                    <span>üëÅ <span x-text="showRequestDetail.views"></span> <span x-text="t.community.viewsCount"></span></span>
                                    <span>üí¨ <span x-text="showRequestDetail.responses"></span> <span x-text="t.community.responsesCount"></span></span>
                                </div>
                                
                                <button @click="sendMessage()" class="w-full btn btn-primary">
                                    <span x-text="t.community.respond"></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </template>
                
                <div class="p-4">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2" x-text="t.community.title"></h2>
                    <p class="text-sm text-gray-600 mb-4" x-text="t.community.subtitle"></p>
                    
                    <!-- Role Notice (Non-volunteers) -->
                    <template x-if="userRole !== 'volunteer'">
                        <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-4 mb-4">
                            <p class="text-sm text-yellow-800">
                                <strong>üì¢ <span x-text="t.community.roleNotice"></span>:</strong>
                                <span x-text="t.community.roleNoticeText"></span>
                            </p>
                        </div>
                    </template>
                    
                    <!-- Filters -->
                    <div class="flex space-x-2 mb-4 overflow-x-auto pb-2">
                        <button @click="communityFilter = 'all'" :class="communityFilter === 'all' ? 'bg-coop-500 text-white' : 'bg-gray-100 text-gray-700'" class="px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors" x-text="t.community.filter.all"></button>
                        <button @click="communityFilter = 'requests'" :class="communityFilter === 'requests' ? 'bg-blue-500 text-white' : 'bg-gray-100 text-gray-700'" class="px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors" x-text="t.community.filter.requests"></button>
                        <button @click="communityFilter = 'offers'" :class="communityFilter === 'offers' ? 'bg-green-500 text-white' : 'bg-gray-100 text-gray-700'" class="px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors" x-text="t.community.filter.offers"></button>
                        <button @click="communityFilter = 'exchanges'" :class="communityFilter === 'exchanges' ? 'bg-purple-500 text-white' : 'bg-gray-100 text-gray-700'" class="px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors" x-text="t.community.filter.exchanges"></button>
                    </div>
                    
                    <!-- Create Post Button -->
                    <button class="w-full btn btn-outline mb-6">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                        </svg>
                        <span x-text="t.community.createPost"></span>
                    </button>
                    
                    <!-- Request Cards -->
                    <div class="space-y-4">
                        <template x-for="request in getCommunityRequests()" :key="request.id">
                            <div @click="showRequestDetail = request" class="request-card card-interactive" :class="'type-' + request.type + (request.urgency === 'urgent' ? ' urgency-urgent' : '')">
                                <div class="flex items-start justify-between mb-3">
                                    <div class="flex items-center space-x-2">
                                        <span class="text-xl" x-text="request.categoryInfo?.icon"></span>
                                        <span class="px-2 py-1 rounded-md text-xs font-medium" :class="getCategoryColor(request.categoryInfo?.color)" x-text="language === 'en' ? request.categoryInfo?.nameEn : request.categoryInfo?.name"></span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="px-2 py-1 rounded-md text-xs font-medium" :class="getTypeBadgeClass(request.type)" x-text="t.community.requestTypes[request.type]"></span>
                                        <template x-if="request.urgency === 'urgent'">
                                            <span class="px-2 py-1 rounded-md text-xs font-medium bg-red-100 text-red-700">üî¥</span>
                                        </template>
                                    </div>
                                </div>
                                
                                <h3 class="font-semibold text-gray-800 mb-2" x-text="request.displayTitle"></h3>
                                
                                <div class="flex items-center text-xs text-gray-500 mb-3">
                                    <span x-text="request.displayArea"></span>
                                    <span class="mx-2">‚Ä¢</span>
                                    <span x-text="request.userName"></span>
                                    <span class="mx-2">‚Ä¢</span>
                                    <span x-text="formatTimeAgo(request.createdAt)"></span>
                                </div>
                                
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center text-xs text-gray-500">
                                        <span>üëÅ <span x-text="request.views"></span></span>
                                        <span class="mx-2">‚Ä¢</span>
                                        <span>üí¨ <span x-text="request.responses"></span></span>
                                    </div>
                                    <button class="text-coop-600 text-sm font-medium" x-text="t.community.respond"></button>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
            
            <!-- ============================================
                 EVENTS VIEW
                 ============================================ -->
            <div x-show="currentView === 'events'" class="view-transition">
                <!-- Event Detail Modal -->
                <template x-if="selectedEvent">
                    <div class="fixed inset-0 z-50 bg-black/50 flex items-end sm:items-center justify-center" @click.self="selectedEvent = null">
                        <div class="bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-lg max-h-[90vh] overflow-y-auto animate-slide-up">
                            <div class="p-4 border-b sticky top-0 bg-white">
                                <div class="flex items-center justify-between">
                                    <h3 class="font-bold text-lg" x-text="selectedEvent.displayTitle"></h3>
                                    <button @click="selectedEvent = null" class="p-2 hover:bg-gray-100 rounded-full">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="p-4">
                                <div class="flex items-center space-x-2 mb-4">
                                    <span class="px-3 py-1 rounded-full text-xs font-medium bg-coop-100 text-coop-700" x-text="selectedEvent.displayCategory"></span>
                                    <template x-if="selectedEvent.featured">
                                        <span class="px-3 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-700">‚≠ê <span x-text="t.events.featured"></span></span>
                                    </template>
                                </div>
                                
                                <p class="text-gray-700 mb-6" x-text="selectedEvent.displayDescription"></p>
                                
                                <div class="bg-gray-50 rounded-lg p-4 mb-6 space-y-3">
                                    <div class="flex items-start">
                                        <svg class="w-5 h-5 text-gray-400 mr-3 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                        </svg>
                                        <div>
                                            <p class="text-sm text-gray-500" x-text="t.events.date"></p>
                                            <p class="font-medium" x-text="formatDate(selectedEvent.date) + ' ' + selectedEvent.time + ' - ' + selectedEvent.endTime"></p>
                                        </div>
                                    </div>
                                    <div class="flex items-start">
                                        <svg class="w-5 h-5 text-gray-400 mr-3 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                        </svg>
                                        <div>
                                            <p class="text-sm text-gray-500" x-text="t.events.location"></p>
                                            <p class="font-medium" x-text="selectedEvent.displayLocation"></p>
                                        </div>
                                    </div>
                                    <div class="flex items-start">
                                        <svg class="w-5 h-5 text-gray-400 mr-3 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"></path>
                                        </svg>
                                        <div>
                                            <p class="text-sm text-gray-500" x-text="t.events.fee"></p>
                                            <p class="font-medium" x-text="selectedEvent.fee === 0 ? t.common.free : '¬•' + selectedEvent.fee.toLocaleString()"></p>
                                        </div>
                                    </div>
                                    <div class="flex items-start">
                                        <svg class="w-5 h-5 text-gray-400 mr-3 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                                        </svg>
                                        <div>
                                            <p class="text-sm text-gray-500" x-text="t.events.capacity"></p>
                                            <p class="font-medium"><span x-text="selectedEvent.registered"></span>/<span x-text="selectedEvent.capacity"></span></p>
                                        </div>
                                    </div>
                                </div>
                                
                                <template x-if="!selectedEvent.canRegister">
                                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4">
                                        <p class="text-sm text-yellow-800" x-text="t.events.restrictedEvent"></p>
                                    </div>
                                </template>
                                
                                <button 
                                    @click="registerForEvent(selectedEvent)"
                                    :disabled="selectedEvent.isFull || !selectedEvent.canRegister"
                                    :class="selectedEvent.isFull || !selectedEvent.canRegister ? 'bg-gray-300 cursor-not-allowed' : 'btn-primary'"
                                    class="w-full btn">
                                    <span x-text="selectedEvent.isFull ? t.events.full : t.events.register"></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </template>
                
                <div class="p-4">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2" x-text="t.events.title"></h2>
                    <p class="text-sm text-gray-600 mb-6" x-text="t.events.subtitle"></p>
                    
                    <!-- Featured Events -->
                    <template x-if="getFeaturedEvents().length > 0">
                        <div class="mb-6">
                            <h3 class="text-lg font-bold text-gray-800 mb-4" x-text="t.events.featured"></h3>
                            <template x-for="event in getFeaturedEvents()" :key="event.id">
                                <div @click="selectedEvent = event" class="event-card event-card-featured p-4 mb-4 card-interactive">
                                    <div class="flex items-start">
                                        <div class="event-date-badge mr-4 flex-shrink-0">
                                            <span class="month" x-text="new Date(event.date).toLocaleDateString(language === 'ja' ? 'ja-JP' : 'en-US', { month: 'short' })"></span>
                                            <span class="day" x-text="new Date(event.date).getDate()"></span>
                                        </div>
                                        <div class="flex-1 min-w-0">
                                            <span class="inline-block px-2 py-1 text-xs font-medium rounded-md bg-white/80 text-coop-700 mb-2" x-text="event.displayCategory"></span>
                                            <h4 class="font-bold text-gray-800 mb-1" x-text="event.displayTitle"></h4>
                                            <p class="text-sm text-gray-600 mb-2" x-text="event.displayLocation"></p>
                                            <div class="flex items-center text-xs text-gray-500">
                                                <span x-text="event.time"></span>
                                                <span class="mx-2">‚Ä¢</span>
                                                <span x-text="event.spotsRemaining + ' ' + (language === 'ja' ? 'Â∏≠Á©∫„Åç' : 'spots left')"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </template>
                    
                    <!-- Upcoming Events -->
                    <div>
                        <h3 class="text-lg font-bold text-gray-800 mb-4" x-text="t.events.upcoming"></h3>
                        <div class="space-y-3">
                            <template x-for="event in getUpcomingEvents().filter(e => !e.featured)" :key="event.id">
                                <div @click="selectedEvent = event" class="card p-4 card-interactive">
                                    <div class="flex items-start">
                                        <div class="event-date-badge mr-4 flex-shrink-0">
                                            <span class="month" x-text="new Date(event.date).toLocaleDateString(language === 'ja' ? 'ja-JP' : 'en-US', { month: 'short' })"></span>
                                            <span class="day" x-text="new Date(event.date).getDate()"></span>
                                        </div>
                                        <div class="flex-1 min-w-0">
                                            <span class="inline-block px-2 py-1 text-xs font-medium rounded-md bg-gray-100 text-gray-700 mb-2" x-text="event.displayCategory"></span>
                                            <h4 class="font-semibold text-gray-800 mb-1" x-text="event.displayTitle"></h4>
                                            <p class="text-sm text-gray-600" x-text="event.displayLocation"></p>
                                            <template x-if="event.roleRestricted">
                                                <span class="inline-block mt-2 px-2 py-1 text-xs font-medium rounded-md bg-purple-100 text-purple-700">üîí <span x-text="t.roles.reijikai.name"></span></span>
                                            </template>
                                        </div>
                                        <template x-if="event.isFull">
                                            <span class="px-2 py-1 text-xs font-medium rounded-md bg-red-100 text-red-700" x-text="t.events.full"></span>
                                        </template>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ============================================
                 KNOWLEDGE BASE VIEW
                 ============================================ -->
            <div x-show="currentView === 'knowledge'" class="view-transition">
                <!-- Article Detail -->
                <template x-if="selectedArticle">
                    <div class="p-4">
                        <button @click="selectedArticle = null" class="flex items-center text-coop-600 mb-4">
                            <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                            </svg>
                            <span x-text="t.common.back"></span>
                        </button>
                        
                        <article class="bg-white rounded-xl p-6 shadow-sm">
                            <div class="flex items-center space-x-2 mb-4">
                                <span class="text-2xl" x-text="selectedArticle.categoryInfo?.icon"></span>
                                <span class="px-3 py-1 text-xs font-medium rounded-full bg-coop-100 text-coop-700" x-text="language === 'en' ? selectedArticle.categoryInfo?.nameEn : selectedArticle.categoryInfo?.name"></span>
                            </div>
                            <h1 class="text-2xl font-bold text-gray-800 mb-4" x-text="selectedArticle.displayTitle"></h1>
                            <div class="prose prose-sm max-w-none text-gray-700 whitespace-pre-line" x-text="selectedArticle.displayContent"></div>
                            
                            <div class="mt-6 pt-6 border-t flex items-center justify-between text-sm text-gray-500">
                                <span>üëÅ <span x-text="selectedArticle.views"></span> <span x-text="t.common.views"></span></span>
                                <span>üëç <span x-text="selectedArticle.helpful"></span> <span x-text="t.knowledge.helpful"></span></span>
                            </div>
                        </article>
                    </div>
                </template>
                
                <!-- Knowledge List -->
                <template x-if="!selectedArticle">
                    <div class="p-4">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2" x-text="t.knowledge.title"></h2>
                        <p class="text-sm text-gray-600 mb-4" x-text="t.knowledge.subtitle"></p>
                        
                        <!-- Search -->
                        <div class="relative mb-4">
                            <svg class="w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                            </svg>
                            <input 
                                type="text" 
                                x-model="knowledgeSearch"
                                :placeholder="t.knowledge.searchPlaceholder"
                                class="input pl-10">
                        </div>
                        
                        <!-- Categories -->
                        <div class="flex space-x-2 mb-6 overflow-x-auto pb-2">
                            <button @click="knowledgeCategory = 'all'" :class="knowledgeCategory === 'all' ? 'bg-coop-500 text-white' : 'bg-gray-100 text-gray-700'" class="px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors" x-text="t.common.all"></button>
                            <template x-for="cat in CoopData.knowledgeCategories" :key="cat.id">
                                <button @click="knowledgeCategory = cat.id" :class="knowledgeCategory === cat.id ? 'bg-coop-500 text-white' : 'bg-gray-100 text-gray-700'" class="px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors">
                                    <span x-text="cat.icon"></span>
                                    <span x-text="language === 'en' ? cat.nameEn : cat.name"></span>
                                </button>
                            </template>
                        </div>
                        
                        <!-- Articles -->
                        <div class="space-y-3">
                            <template x-for="article in getKnowledgeArticles()" :key="article.id">
                                <div @click="selectedArticle = article" class="knowledge-card card-interactive">
                                    <div class="flex items-start">
                                        <span class="text-2xl mr-3" x-text="article.categoryInfo?.icon"></span>
                                        <div class="flex-1 min-w-0">
                                            <h3 class="font-semibold text-gray-800 mb-1" x-text="article.displayTitle"></h3>
                                            <div class="flex items-center text-xs text-gray-500">
                                                <span>üëÅ <span x-text="article.views"></span></span>
                                                <span class="mx-2">‚Ä¢</span>
                                                <span>üëç <span x-text="article.helpful"></span></span>
                                            </div>
                                        </div>
                                        <svg class="w-5 h-5 text-gray-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                        </svg>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                </template>
            </div>
            
            <!-- ============================================
                 DECISIONS VIEW (REIJIKAI ONLY)
                 ============================================ -->
            <div x-show="currentView === 'decisions' && userRole === 'reijikai'" class="view-transition">
                <div class="p-4">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2" x-text="t.decisions.title"></h2>
                    
                    <!-- Stats -->
                    <div class="grid grid-cols-3 gap-3 mb-6">
                        <div class="bg-white rounded-xl p-4 text-center shadow-sm">
                            <p class="text-2xl font-bold text-gray-800">2</p>
                            <p class="text-xs text-gray-500" x-text="t.decisions.activeProposals"></p>
                        </div>
                        <div class="bg-white rounded-xl p-4 text-center shadow-sm">
                            <p class="text-2xl font-bold text-gray-800">68%</p>
                            <p class="text-xs text-gray-500" x-text="t.decisions.participationRate"></p>
                        </div>
                        <div class="bg-white rounded-xl p-4 text-center shadow-sm">
                            <p class="text-2xl font-bold text-gray-800">2.5</p>
                            <p class="text-xs text-gray-500" x-text="t.decisions.avgResponseTime"></p>
                        </div>
                    </div>
                    
                    <!-- New Proposal Button -->
                    <button class="w-full btn btn-primary mb-6">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                        </svg>
                        <span x-text="t.decisions.newProposal"></span>
                    </button>
                    
                    <!-- Active Proposals -->
                    <h3 class="text-lg font-bold text-gray-800 mb-4" x-text="t.decisions.activeProposals"></h3>
                    
                    <div class="space-y-4">
                        <template x-for="proposal in getProposals()" :key="proposal.id">
                            <div class="proposal-card">
                                <div class="flex items-start justify-between mb-3">
                                    <div class="flex-1">
                                        <span class="inline-block px-2 py-1 text-xs font-medium rounded-md mb-2" :class="getStatusBadgeClass(proposal.status)" x-text="proposal.displayStatus"></span>
                                        <h4 class="font-bold text-gray-800 mb-1" x-text="proposal.displayTitle"></h4>
                                        <p class="text-sm text-gray-600" x-text="proposal.displayDescription"></p>
                                    </div>
                                </div>
                                
                                <!-- Vote Progress -->
                                <div class="mb-4">
                                    <div class="vote-bar mb-2">
                                        <div class="vote-bar-yes" :style="'width: ' + (proposal.votes.yes / proposal.totalVotes * 100) + '%'"></div>
                                        <div class="vote-bar-no" :style="'width: ' + (proposal.votes.no / proposal.totalVotes * 100) + '%'"></div>
                                        <div class="vote-bar-abstain" :style="'width: ' + (proposal.votes.abstain / proposal.totalVotes * 100) + '%'"></div>
                                    </div>
                                    <div class="flex justify-between text-xs">
                                        <span class="text-green-600">‚úì <span x-text="proposal.votes.yes"></span></span>
                                        <span class="text-red-600">‚úó <span x-text="proposal.votes.no"></span></span>
                                        <span class="text-gray-500">‚Äî <span x-text="proposal.votes.abstain"></span></span>
                                    </div>
                                </div>
                                
                                <div class="flex items-center justify-between text-xs text-gray-500">
                                    <span><span x-text="t.decisions.deadline"></span>: <span x-text="formatDate(proposal.deadline)"></span></span>
                                    <span><span x-text="t.decisions.totalVotes"></span>: <span x-text="proposal.totalVotes"></span></span>
                                </div>
                                
                                <template x-if="proposal.status === 'active'">
                                    <button class="w-full btn btn-outline mt-4" x-text="t.decisions.castVote"></button>
                                </template>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
            
            <!-- ============================================
                 CONTENT MANAGEMENT VIEW (SHOKUIN ONLY)
                 ============================================ -->
            <div x-show="currentView === 'content' && userRole === 'shokuin'" class="view-transition">
                <div class="p-4">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4" x-text="t.content.title"></h2>
                    
                    <!-- Tabs -->
                    <div class="flex space-x-2 mb-6 border-b">
                        <button @click="contentTab = 'news'" :class="contentTab === 'news' ? 'border-b-2 border-coop-500 text-coop-600' : 'text-gray-500'" class="px-4 py-3 font-medium text-sm" x-text="t.content.tabs.news"></button>
                        <button @click="contentTab = 'events'" :class="contentTab === 'events' ? 'border-b-2 border-coop-500 text-coop-600' : 'text-gray-500'" class="px-4 py-3 font-medium text-sm" x-text="t.content.tabs.events"></button>
                        <button @click="contentTab = 'knowledge'" :class="contentTab === 'knowledge' ? 'border-b-2 border-coop-500 text-coop-600' : 'text-gray-500'" class="px-4 py-3 font-medium text-sm" x-text="t.content.tabs.knowledge"></button>
                    </div>
                    
                    <!-- Stats -->
                    <div class="grid grid-cols-3 gap-3 mb-6">
                        <div class="bg-white rounded-xl p-4 text-center shadow-sm">
                            <p class="text-2xl font-bold text-gray-800">24</p>
                            <p class="text-xs text-gray-500" x-text="t.content.totalPosts"></p>
                        </div>
                        <div class="bg-white rounded-xl p-4 text-center shadow-sm">
                            <p class="text-2xl font-bold text-gray-800">8</p>
                            <p class="text-xs text-gray-500" x-text="t.content.thisMonth"></p>
                        </div>
                        <div class="bg-white rounded-xl p-4 text-center shadow-sm">
                            <p class="text-2xl font-bold text-gray-800">287</p>
                            <p class="text-xs text-gray-500" x-text="t.content.avgViews"></p>
                        </div>
                    </div>
                    
                    <!-- New Content Button -->
                    <button class="w-full btn btn-primary mb-6">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                        </svg>
                        <span x-text="t.content.newPost"></span>
                    </button>
                    
                    <!-- Content List -->
                    <h3 class="text-lg font-bold text-gray-800 mb-4" x-text="t.content.publishedNews"></h3>
                    
                    <div class="space-y-3">
                        <template x-for="article in getNewsArticles()" :key="article.id">
                            <div class="card p-4">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1 min-w-0">
                                        <span class="inline-block px-2 py-1 text-xs font-medium rounded-md bg-coop-100 text-coop-700 mb-2" x-text="article.displayCategory"></span>
                                        <h4 class="font-semibold text-gray-800 mb-1" x-text="article.displayTitle"></h4>
                                        <div class="flex items-center text-xs text-gray-500">
                                            <span x-text="formatShortDate(article.date)"></span>
                                            <span class="mx-2">‚Ä¢</span>
                                            <span>üëÅ <span x-text="article.views"></span></span>
                                        </div>
                                    </div>
                                    <div class="flex space-x-2 ml-2">
                                        <button class="p-2 hover:bg-gray-100 rounded-lg">
                                            <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                            </svg>
                                        </button>
                                        <button class="p-2 hover:bg-red-50 rounded-lg">
                                            <svg class="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
            
            <!-- ============================================
                 PROFILE VIEW
                 ============================================ -->
            <div x-show="currentView === 'profile'" class="view-transition">
                <div class="p-4">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6" x-text="t.profile.title"></h2>
                    
                    <!-- Profile Card -->
                    <div class="bg-white rounded-xl p-6 shadow-sm mb-6">
                        <div class="flex items-center mb-6">
                            <div class="w-20 h-20 bg-coop-100 rounded-full flex items-center justify-center mr-4">
                                <span class="text-4xl" x-text="user?.avatar || 'üë§'"></span>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800" x-text="getUserName()"></h3>
                                <p class="text-sm text-gray-500" x-text="user?.nickname"></p>
                                <span class="badge mt-2" :class="getRoleBadgeClass()" x-text="getRoleFullName()"></span>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <p class="text-gray-500" x-text="t.common.memberNumber"></p>
                                <p class="font-medium" x-text="user?.id"></p>
                            </div>
                            <div>
                                <p class="text-gray-500" x-text="t.common.area"></p>
                                <p class="font-medium" x-text="getUserArea()"></p>
                            </div>
                            <div>
                                <p class="text-gray-500" x-text="t.profile.memberSince"></p>
                                <p class="font-medium" x-text="formatDate(user?.memberSince)"></p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Services Offered -->
                    <div class="bg-white rounded-xl p-6 shadow-sm mb-6">
                        <h4 class="font-bold text-gray-800 mb-4" x-text="t.profile.servicesOffered"></h4>
                        <div class="flex flex-wrap gap-2">
                            <template x-for="service in user?.servicesOffered || []" :key="service">
                                <span class="px-3 py-1 rounded-full text-sm border" :class="getCategoryColor(getServiceCategory(service)?.color)">
                                    <span x-text="getServiceCategory(service)?.icon"></span>
                                    <span x-text="language === 'en' ? getServiceCategory(service)?.nameEn : getServiceCategory(service)?.name"></span>
                                </span>
                            </template>
                            <template x-if="!user?.servicesOffered?.length">
                                <p class="text-sm text-gray-500">‚Äî</p>
                            </template>
                        </div>
                    </div>
                    
                    <!-- Services Needed -->
                    <div class="bg-white rounded-xl p-6 shadow-sm mb-6">
                        <h4 class="font-bold text-gray-800 mb-4" x-text="t.profile.servicesNeeded"></h4>
                        <div class="flex flex-wrap gap-2">
                            <template x-for="service in user?.servicesNeeded || []" :key="service">
                                <span class="px-3 py-1 rounded-full text-sm border" :class="getCategoryColor(getServiceCategory(service)?.color)">
                                    <span x-text="getServiceCategory(service)?.icon"></span>
                                    <span x-text="language === 'en' ? getServiceCategory(service)?.nameEn : getServiceCategory(service)?.name"></span>
                                </span>
                            </template>
                            <template x-if="!user?.servicesNeeded?.length">
                                <p class="text-sm text-gray-500">‚Äî</p>
                            </template>
                        </div>
                    </div>
                    
                    <!-- Privacy Settings -->
                    <div class="bg-white rounded-xl p-6 shadow-sm">
                        <h4 class="font-bold text-gray-800 mb-4" x-text="t.profile.privacySettings"></h4>
                        <div class="space-y-4 text-sm">
                            <div class="flex items-center justify-between">
                                <span class="text-gray-700" x-text="t.profile.showRealName"></span>
                                <span class="font-medium" x-text="user?.privacy?.showRealName ? t.common.yes : t.common.no"></span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-gray-700" x-text="t.profile.locationPrecision"></span>
                                <span class="font-medium" x-text="t.profile.locationOptions[user?.privacy?.locationPrecision]"></span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-gray-700" x-text="t.profile.contactMethod"></span>
                                <span class="font-medium" x-text="t.profile.contactOptions[user?.privacy?.contactMethod]"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </main>
        
        <!-- ============================================
             BOTTOM NAVIGATION
             ============================================ -->
        <nav class="bottom-nav hide-desktop">
            <div class="flex justify-around items-center py-2">
                <button @click="navigate('dashboard')" class="bottom-nav-item" :class="currentView === 'dashboard' ? 'active' : ''">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                    </svg>
                    <span x-text="t.nav.home"></span>
                </button>
                
                <button @click="navigate('news')" class="bottom-nav-item" :class="currentView === 'news' ? 'active' : ''">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path>
                    </svg>
                    <span x-text="t.nav.news"></span>
                </button>
                
                <button @click="navigate('community')" class="bottom-nav-item" :class="currentView === 'community' ? 'active' : ''">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                    </svg>
                    <span x-text="t.nav.community"></span>
                </button>
                
                <button @click="navigate('events')" class="bottom-nav-item" :class="currentView === 'events' ? 'active' : ''">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                    <span x-text="t.nav.events"></span>
                </button>
                
                <button @click="showMoreMenu = true" class="bottom-nav-item">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                    <span x-text="t.nav.more"></span>
                </button>
            </div>
        </nav>
        
        <!-- ============================================
             MORE MENU (SLIDE UP)
             ============================================ -->
        <template x-if="showMoreMenu">
            <div>
                <div class="more-menu-overlay animate-fade-in" @click="showMoreMenu = false"></div>
                <div class="more-menu animate-slide-up">
                    <div class="more-menu-handle"></div>
                    
                    <div class="space-y-1">
                        <!-- Knowledge Base -->
                        <button @click="navigate('knowledge')" class="more-menu-item w-full">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                            </svg>
                            <span x-text="t.nav.knowledge"></span>
                        </button>
                        
                        <!-- Profile -->
                        <button @click="navigate('profile')" class="more-menu-item w-full">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                            <span x-text="t.nav.profile"></span>
                        </button>
                        
                        <!-- Role-specific items -->
                        <template x-if="userRole === 'reijikai'">
                            <button @click="navigate('decisions')" class="more-menu-item w-full">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
                                </svg>
                                <span x-text="t.nav.decisions"></span>
                            </button>
                        </template>
                        
                        <template x-if="userRole === 'shokuin'">
                            <button @click="navigate('content')" class="more-menu-item w-full">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                </svg>
                                <span x-text="t.nav.contentManagement"></span>
                            </button>
                        </template>
                        
                        <!-- Shop (External Link) -->
                        <button class="more-menu-item w-full">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
                            </svg>
                            <span x-text="t.nav.shop"></span>
                            <svg class="w-4 h-4 ml-auto text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                            </svg>
                        </button>
                        
                        <div class="border-t my-4"></div>
                        
                        <!-- Logout -->
                        <button @click="logout()" class="more-menu-item w-full text-red-600">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" class="!text-red-600">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                            </svg>
                            <span x-text="t.common.logout" class="!text-red-600"></span>
                        </button>
                    </div>
                    
                    <!-- App Info -->
                    <div class="mt-6 text-center text-xs text-gray-400">
                        <p x-text="t.common.appName"></p>
                        <p><span x-text="t.more.version"></span> 1.0.0 POC</p>
                    </div>
                </div>
            </div>
        </template>
        
    </div>

    <!-- Scripts - Order matters! Dependencies first, then Alpine -->
    <script src="js/data.js"></script>
    <script src="js/i18n.js"></script>
    <script src="js/app.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Register Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('Service Worker registered'))
                    .catch(err => console.log('Service Worker registration failed:', err));
            });
        }
    </script>
</body>
</html>